<html>
    <head>
        <script type="text/javascript" src="lib/jquery-1.6.1.min.js"></script>
        <script type="text/javascript" src="lib/underscore.js"></script>

        <script type="text/javascript" src="src/Array.js"></script>
        <script type="text/javascript" src="src/Vector.js"></script>
        <script type="text/javascript" src="src/Node.js"></script>
        <script type="text/javascript" src="src/LocationRandomizer.js"></script>
        <script type="text/javascript" src="src/NodesCreator.js"></script>
        <script type="text/javascript" src="src/CoulombRepulsion.js"></script>
        <script type="text/javascript" src="src/HookeAttraction.js"></script>
        <script type="text/javascript" src="src/Forces.js"></script>
        <script type="text/javascript" src="src/ForceLocationCalculator.js"></script>

        <script type="text/javascript">
            $(document).ready(function() {
                    var randomizer = locationRandomizer(600, 600, 10);
                    var indexNodexCreator = nodesCreator(10, randomizer);
                    var nodes = indexNodexCreator.createNodes();
                    nodes[0].connectWith(nodes[1]);
                    nodes[0].connectWith(nodes[2]);
                    nodes[2].connectWith(nodes[3]);
                    nodes[3].connectWith(nodes[2]);
                    nodes[4].connectWith(nodes[3]);
                    nodes[5].connectWith(nodes[0]);
                    nodes[6].connectWith(nodes[0]);
                    nodes[7].connectWith(nodes[4]);
                    nodes[8].connectWith(nodes[4]);
                    nodes[9].connectWith(nodes[1]);

                    var repulsion = coulombRepulsion();
                    var attraction = hookeAttraction();
                    var nodeForces = forces(repulsion, attraction);
                    var locationCalculator = forceLocationCalculator(nodeForces);
                    var canvas = $('#canvas')[0];
                    var context = canvas.getContext('2d');

                    var i = 0;
                    while(true) {
                        drawNodes(nodes, context);
                        locationCalculator.updateLocationOf(nodes, vector(0, 0));
                        alert("Iteration " + i);
                        i++;
                    }
            });

            function drawNodes(nodes, context) {
                clearCanvas(canvas, context);
                for (var i=0; i<nodes.length; i++) {
                    nodes[i].draw(context);
                }
            }

            function clearCanvas(canvas, context) {
                context.clearRect(0, 0, canvas.width, canvas.height);
                var width = canvas.width;
                canvas.width = 1;
                canvas.width = width;
            }
        </script>
    </head>
    <body>
        <canvas id="canvas" width="600" height="600" />
    </body>
</html>
